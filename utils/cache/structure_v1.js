// ===========================================
// structure_v1.js
// ▼ GPT向けデータ構造説明ブロック
// ===========================================
module.exports = `
### contexts（体質・タイプ情報）
- type：体質タイプ名（例：陰虚タイプなど）
- trait：体質傾向（例：潤い不足で熱がこもりやすい 等）
- flowType：流通病理（例：気滞・水滞・瘀血・巡り良好）
- organType：負担が出やすい経絡ライン（皮膚・筋膜のつながり）および、関連性の強い臓腑（例：肝・心・脾・肺・腎）
- motion：最も伸展負担がかかる経絡ラインの伸展動作。organType を決めるための指標として使っているテスト動作。
- symptom：不調主訴（例：胃腸・肩こり・メンタル・冷えなど）の種類。

※ ユーザーには、
「いま気になっている不調（symptom）は  
　①『type / trait』としての体質的な特徴に加え、  
　② 体内の巡りの状態（flowType）、  
　③ 体表面の経絡ライン（organType）のこわばり  
　の三つが重なって表れている」
という3層構造で説明している。

- advice：{habits, breathing, stretch, tsubo, kampo} 各ケア内容と図解リンクのテキスト。
- created_at：初回登録日（体質分析を終えた日）

## 🔸 adviceの優先ケアとサポートケアの分け方について
- flowType の状態を指標に、ざっくり次のように優先ケアとサポートケアに分けてユーザーに提示している：
  - 気滞の傾向：
    - 優先：呼吸法（呼吸で胸〜お腹まわりの詰まりをまずぬく）／ツボケア（伸展負荷のある経絡ラインのストレッチで余計に力んでしまうことを避けるため、まずはライン上の手足のツボや指先のケアから優先）
    - サポート：ストレッチ・体質改善習慣・漢方・サプリ
  - 瘀血の傾向：
    - 優先：ツボケア（まず滞りのある経絡ラインの手足末端のツボで血の巡りを促す）／呼吸法（深部の動きの悪い組織を、内側から再起動させるようなテンポの良い深い呼吸）
    - サポート：ストレッチ・体質改善習慣・漢方・サプリ
  - 水滞の傾向：
    - 優先：優先：呼吸法（横隔膜や腹圧をしっかり動かし、気の推動力を高める呼吸）／ストレッチ（流れにくくなっている経絡ラインの“通り道”を広げる）
    - サポート：体質改善習慣・ツボケア・漢方・サプリ
  - 巡りは良好：
    - 優先：体質改善習慣（生活習慣全般で体質を整える）／ストレッチ（伸展負荷の表れている経絡ライン全体の通りをよくする。）
    - サポート：呼吸法・ツボケア・漢方・サプリ

### followups（ととのい度チェック）
- latest：直近のチェック結果。以下の項目を含む：
  - symptom_level：不調(主訴)のつらさ（1=軽くなっている〜5=体質分析時点と変わらず辛い）
  - sleep：睡眠リズムの整い具合（1=整っている〜5=乱れがち）
  - meal：食事のタイミングや量の整い具合（1=整っている〜5=乱れがち）
  - stress：ストレスや気分の安定度（1=安定〜5=不安定）
  - motion_level：最も伸展負荷がかかる経絡ラインの伸展動作(motion)を再チェックしたときのつらさの経過観察（1=軽くなっている〜5=体質分析時時点と変わらず辛い）
- prev：前回のチェック結果（存在する場合）。latest と同じ構造。
- AIは latest と prev の差分から、「ラクになってきているか／ややツラさが戻っているか」などの傾向を読み取る。

### care_logs_daily（ケア記録）
- habits / breathing / stretch / tsubo / kampo：各ケア項目を「行った日」の数。
- 1日に同じケアを何度行っても“1日＝1カウント”として扱う。
- buildConsultMessagesでは、主に次の2種類の集計が使われる：
  - shortTermCareCounts：前回のととのい度チェック日〜今回のチェック日までの実施日数。
  - longTermCareCounts：体質分析（contexts.created_at）〜現在までの累計実施日数。
- 短期のカウントは「直近の1〜数週間でどのケアがどれくらい行われたか」を示し、
  長期のカウントは「全体としてどのケアをベースに積み上げてきたか」を示す。

### recentChats（直近の相談履歴）
- 直近3件分の会話（user / assistant）の短い要約が入る。
- AIは、同じ話題が続いている場合や、前回の提案との整合性をとるために参照する。
`;
